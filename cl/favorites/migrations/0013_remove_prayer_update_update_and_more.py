# Generated by Django 6.0.1 on 2026-01-27 04:17

import pgtrigger.compiler
import pgtrigger.migrations
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('favorites', '0012_genericcount'),
    ]

    operations = [
        pgtrigger.migrations.RemoveTrigger(
            model_name='prayer',
            name='update_update',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='prayer',
            name='delete_delete',
        ),
        migrations.AddField(
            model_name='prayer',
            name='via_api',
            field=models.BooleanField(db_index=True, default=False, help_text='Whether the prayer was created via the API (unlimited)'),
        ),
        migrations.AddField(
            model_name='prayerevent',
            name='via_api',
            field=models.BooleanField(default=False, help_text='Whether the prayer was created via the API (unlimited)'),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='prayer',
            trigger=pgtrigger.compiler.Trigger(name='update_update', sql=pgtrigger.compiler.UpsertTriggerSql(condition='WHEN (OLD."id" IS DISTINCT FROM (NEW."id") OR OLD."recap_document_id" IS DISTINCT FROM (NEW."recap_document_id") OR OLD."status" IS DISTINCT FROM (NEW."status") OR OLD."user_id" IS DISTINCT FROM (NEW."user_id") OR OLD."via_api" IS DISTINCT FROM (NEW."via_api"))', func='INSERT INTO "favorites_prayerevent" ("date_created", "id", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "recap_document_id", "status", "user_id", "via_api") VALUES (OLD."date_created", OLD."id", _pgh_attach_context(), NOW(), \'update\', OLD."id", OLD."recap_document_id", OLD."status", OLD."user_id", OLD."via_api"); RETURN NULL;', hash='c011dfac3a975f99931c9f19c07055c1e4220f74', operation='UPDATE', pgid='pgtrigger_update_update_4ac15', table='favorites_prayer', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='prayer',
            trigger=pgtrigger.compiler.Trigger(name='delete_delete', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "favorites_prayerevent" ("date_created", "id", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "recap_document_id", "status", "user_id", "via_api") VALUES (OLD."date_created", OLD."id", _pgh_attach_context(), NOW(), \'delete\', OLD."id", OLD."recap_document_id", OLD."status", OLD."user_id", OLD."via_api"); RETURN NULL;', hash='ced349d8c2abc356b1ac45c5b776525f34b3fbee', operation='DELETE', pgid='pgtrigger_delete_delete_0bac2', table='favorites_prayer', when='AFTER')),
        ),
    ]
