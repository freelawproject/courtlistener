# Generated by Django 4.2 on 2023-05-01 05:18

from django.db import migrations
import pgtrigger.compiler
import pgtrigger.migrations


class Migration(migrations.Migration):

    dependencies = [
        ("api", "0009_update_triggers"),
    ]

    operations = [
        pgtrigger.migrations.RemoveTrigger(
            model_name="webhook",
            name="update_or_delete_snapshot_update",
        ),
        pgtrigger.migrations.AddTrigger(
            model_name="webhook",
            trigger=pgtrigger.compiler.Trigger(
                name="update_or_delete_snapshot_update",
                sql=pgtrigger.compiler.UpsertTriggerSql(
                    condition='WHEN (OLD."id" IS DISTINCT FROM (NEW."id") OR OLD."date_created" IS DISTINCT FROM (NEW."date_created") OR OLD."user_id" IS DISTINCT FROM (NEW."user_id") OR OLD."event_type" IS DISTINCT FROM (NEW."event_type") OR OLD."url" IS DISTINCT FROM (NEW."url") OR OLD."enabled" IS DISTINCT FROM (NEW."enabled") OR OLD."version" IS DISTINCT FROM (NEW."version") OR OLD."failure_count" IS DISTINCT FROM (NEW."failure_count"))',
                    func='INSERT INTO "api_webhookhistoryevent" ("date_created", "date_modified", "enabled", "event_type", "failure_count", "id", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "url", "user_id", "version") VALUES (OLD."date_created", OLD."date_modified", OLD."enabled", OLD."event_type", OLD."failure_count", OLD."id", _pgh_attach_context(), NOW(), \'update_or_delete_snapshot\', OLD."id", OLD."url", OLD."user_id", OLD."version"); RETURN NULL;',
                    hash="9e47d58e531c3ece232c48322579e379f2852547",
                    operation="UPDATE",
                    pgid="pgtrigger_update_or_delete_snapshot_update_224f9",
                    table="api_webhook",
                    when="AFTER",
                ),
            ),
        ),
    ]
