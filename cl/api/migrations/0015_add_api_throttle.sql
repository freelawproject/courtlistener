BEGIN;
--
-- Create model APIThrottle
--
CREATE TABLE "api_apithrottle" (
    "id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "date_created" timestamp with time zone NOT NULL,
    "date_modified" timestamp with time zone NOT NULL,
    "throttle_type" smallint NOT NULL,
    "blocked" boolean NOT NULL,
    "rate" varchar(20) NOT NULL,
    "notes" text NOT NULL,
    "user_id" integer NOT NULL
);
--
-- Create model APIThrottleEvent
--
CREATE TABLE "api_apithrottleevent" (
    "pgh_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "pgh_created_at" timestamp with time zone NOT NULL,
    "pgh_label" text NOT NULL,
    "id" integer NOT NULL,
    "date_created" timestamp with time zone NOT NULL,
    "date_modified" timestamp with time zone NOT NULL,
    "throttle_type" smallint NOT NULL,
    "blocked" boolean NOT NULL,
    "rate" varchar(20) NOT NULL,
    "notes" text NOT NULL,
    "pgh_context_id" uuid NULL,
    "pgh_obj_id" integer NOT NULL,
    "user_id" integer NOT NULL
);
--
-- Create constraint unique_user_throttle_type on model apithrottle
--
ALTER TABLE "api_apithrottle" ADD CONSTRAINT "unique_user_throttle_type" UNIQUE ("user_id", "throttle_type");
--
-- NOTE: Triggers are not included for replica databases.
-- Event data will stream from production.
--
ALTER TABLE "api_apithrottle" ADD CONSTRAINT "api_apithrottle_user_id_7336c65c_fk_auth_user_id" FOREIGN KEY ("user_id") REFERENCES "auth_user" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "api_apithrottle_date_created_1dc58999" ON "api_apithrottle" ("date_created");
CREATE INDEX "api_apithrottle_date_modified_59d55305" ON "api_apithrottle" ("date_modified");
CREATE INDEX "api_apithrottle_user_id_7336c65c" ON "api_apithrottle" ("user_id");
CREATE INDEX "api_apithrottleevent_pgh_context_id_5e498498" ON "api_apithrottleevent" ("pgh_context_id");
CREATE INDEX "api_apithrottleevent_pgh_obj_id_f47d89df" ON "api_apithrottleevent" ("pgh_obj_id");
CREATE INDEX "api_apithrottleevent_user_id_b2ea1c2c" ON "api_apithrottleevent" ("user_id");
COMMIT;
